---
title: REST服务操作
tags: REST,逍遥神风
grammar_cjkRuby: true
---
[TOC]

---
# rest简介
定义：表征状态转移（英文：Representational State Transfer，简称`REST`）是Roy Fielding博士在2000年他的博士论文中提出来的一种软件架构风格。

目前在三种主流的Web服务实现方案中，因为REST模式的Web服务与复杂的SOAP和XML-RPC对比来讲明显的更加简洁，越来越多的web服务开始采用REST风格设计和实现。例如，Amazon.com提供接近REST风格的Web服务进行图书查找；雅虎提供的Web服务也是REST风格的。


# Rest模式有四种操作，

* POST /uri 创建 `add`
* DELETE /uri/xxx 删除 `del`
* PUT /uri/xxx 更新或创建 `update`
* GET /uri/xxx 查看 `sel`

## GET操作

GET操作是==安全==的。所谓安全是指不管进行多少次操作，资源的状态都不会改变。比如我用GET浏览文章，不管浏览多少次，那篇文章还在那，没有变化。当然，你可能说每浏览一次文章，文章的浏览数就加一，这不也改变了资源的状态么？这并不矛盾，因为这个改变不是GET操作引起的，而是用户自己设定的服务端逻辑造成的。

## PUT与DELETE操作

PUT与DELETE操作是==幂等==的。所谓幂等是指不管进行多少次操作，结果都一样。比如我用PUT修改一篇文章，然后在做同样的操作，每次操作后的结果并没有不同，DELETE也是一样。顺便说一句，因为GET操作是安全的，所以它自然也是幂等的。

## POST操作

POST操作既不是安全的，也不是幂等的，比如常见的POST==重复加载==问题：当我们多次发出同样的POST请求后，其结果是创建出了若干的资源。

安全和幂等的意义在于：当操作没有达到预期的目标时，我们可以不停的重试，而不会对资源产生副作用。从这个意义上说，POST操作往往是有害的，但很多时候我们还是不得不使用它。

## PUT与POST区别

还有一点需要注意的就是，创建操作可以使用POST，也可以使用PUT，区别在于POST 是作用在一个集合资源之上的（/uri），而PUT操作是作用在一个具体资源之上的（/uri/xxx），再通俗点说，如果URL可以在客户端确定，那么就使用PUT，如果是在服务端确定，那么就使用POST，比如说很多资源使用数据库自增主键作为标识信息，而创建的资源的标识信息到底是什么只能由服务端提供，这个时候就必须使用POST。

## GET与POST的使用混淆

### 两者相同点
* 两者都能向服务器发送数据
* 提交的内容的格式相同,都是var_1=value_1&var_2=value_2&.... get和post请求

### 两者区别
* 一个是get（获取），一个是post（发送）。
* get用来告诉服务器需要获取哪些内容（uri+query），向静态页面（uri）请求则直接返回文件内容给浏览器，向一个动态页面请求时可以提供查询参数（query）以获得相应内容。post用来向服务器提交内容，主要是为了提交，而不是为了请求内容，就是说post的初衷并不要求服务器返回内容，只是提交内容让服务器处理（主要是存储或者处理之后再存储）。
* get和post出现混淆是因为对提交的数据处理方法的滥用造成的，数据是无辜的。

### 使用混淆

* 将get提交的用来查询的字段当作是存储数据存入了服务器端文件或者数据库。然后就误以为get是用来提交用于存储的数据的。编写脚本在服务器端通过处理post提交的数据并返回内容。只要有数据，就能用来进行判断，脚本怎写是程序员的事，而不在乎数据来源的形式。这点功能上确实没问题，只是背离的其初始目的而已。

* 由于都是要传送数据，且数据格式相同,使用的时候难免出现张冠李戴，将get数据用来存储、将post数据用来检索返回数据。但是二者还是有区别的，get的长度限制在2048字节，很大程度上限制了get用来传递存储数据的数据的能力；post则无此限制，因此对于大的数据的传递有天然的优势。

* get提交的数据是放在url里，目的是灵活的向服务其提交检索请求，可以在地址栏随时修改数据以变更需要获取的内容，比如直接修改分页的编号就跳到另外一个分页了。post提交的数据放在http请求的正文里，目的在于提交数据并用于服务器端的存储，而不允许用户过多的更改相应数据（主要是相对于在url修改要麻烦很多，url的修改只要点击地址栏输入字符就可以了），除非是专门跑来编辑数据的。

* post和get的安全性在传输的层面上区别不大，但是采用url提交数据的get方式容易被人肉眼看到，或者出现在历史纪录里，还是可能被肉眼看到，都是一些本地的问题。

补充一点就是做大数据日志分析的时候往往可以通过flume针对REST服务4种操作进行切片分析。
